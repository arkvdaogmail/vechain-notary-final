<!DOCTYPE html>
<html>
<head>
    <title>Hash Test</title>
</head>
<body>
    <h1>Core Hash Test</h1>
    <p>This page only tests the document hashing function.</p>
    <hr>
    <input type="file" id="fileInput">
    <button id="hashBtn">1. Generate Hash</button>
    <hr>
    <h2>Result:</h2>
    <div id="result" style="font-family:monospace; word-break: break-all;"></div>

    <script>
        // This function calculates the hash
        async function generateHash() {
            const fileInput = document.getElementById('fileInput');
            const resultDiv = document.getElementById('result');
            const file = fileInput.files[0];

            if (!file) {
                resultDiv.innerText = 'Error: Please select a file first.';
                return;
            }

            try {
                resultDiv.innerText = 'Calculating hash...';
                const fileBuffer = await file.arrayBuffer();
                const hashBuffer = await crypto.subtle.digest('SHA-256', fileBuffer);
                const hash = '0x' + Array.from(new Uint8Array(hashBuffer)).map(b => b.toString(16).padStart(2, '0')).join('');
                
                // Display the final hash
                resultDiv.innerText = `Document Hash: ${hash}`;

            } catch (error) {
                console.error('Hashing Error:', error);
                resultDiv.innerText = `A critical error occurred: ${error.message}`;
            }
        }

        // Attach the function to the button's click event
        document.getElementById('hashBtn').addEventListener('click', generateHash);
    </script>
</body>
</html>

